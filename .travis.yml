sudo: true
dist: trusty
branches:
  only:
  - travis-build
cache: bundler
before_install:
- openssl aes-256-cbc -K $encrypted_c39b1f424b91_key -iv $encrypted_c39b1f424b91_iv
  -in tjy-west-1.pem.enc -out tjy-west-1.pem -d
- gem update --system
- gem --version

env:
  global:
  - secure: vjfr7AFXjrQiwq5zDvbdxe5Scq8pKa9vnY0VKuOFBPiuTuLNJ3KjR42US544WHBQJEHw9PL2QfUfFB1BWJNBEInbDQzRYMvZ/NAsKm/N8MmUlTjNh1IS4IMLbRuTTC+awqTql1WuJSffsgA6XKSnJShFOZGsNfm2JJmcp5kzunkZgugaV4Zjuvcglwrb/0cQ+h5bSw2GSrhV04JbCQ7KwN864Nk2qlLqyR6+jM6Sb6USgiEsoUveyz/H4IX4QQEQzdg0DE1xH+yq2JLtayhTVXXHwWZLq83XScSQ8R/UEN6u788lY/WdCoNDnfBNEFmLRIZVphw8cBTPQm5pRpqNmIlCcoUm9Q4ZiPEeN8A4Z0uPjqm/El6aGCJDlhtnuUSNwibtsS618EyaUNEwXiexHgCQt3ORys3t7spt+x5QzPk5McGBr4QLzUZNIfvHNT10sPe/8UxL6cZhRjjIgNgbsLaTSQe4bRwuIgihmhzbXVrfw0bRDaUi1Yd0wJBqXJJe6psgERyExHsQiUZhfz4Gap5dU6c9qiNn1TX8l6aIDZB8cmh8AJkEghzjskoPwcT6GPAMLOwOmtKhUVFRS6eDAT7IMjYilOsM08yjTAwunv9d5KSwN9hVEcirKGBnRCE6ji6cfTwfLZ6ReyUH00Eusf/ugBjkCr8vRmAcsAYmF8o=
  - secure: c+MKTI4I7J9v7pcubGn5wvGuMg5Sz+MPJJVh2A0qzUkaAPbfNK20MWBmpOpa9uH/WDRMCLNUSrg7k+SypQD+XdyvZAo75eTstNwTpTyYIP8qH8QA0V4Z6N8xTSwbtgkH/LE1nwh5v9wZTlWQoX6cxdQPqGvwSQ9/k6TH+GZ5HT7gP8/shm/YCKQ/O/zhSD4zP+JNSDokVh7vWKxRDv6ULyILMAbjLtu5f89dpUfcSAXw3VB3tpNIkzQW86uQiLGrpb9+HG0TreIg/Wd+n6l3H+5RjdCI+dzaZDsB2uNh41nUpYyrB40I+T4z19YsXPVIoErssGhQ+ZMAJpir7GbMIsiL7yZVYrvFzSk5w/Su2lbhcnayfpvgtvdaLOmcwwRXdDHQUL9rbt0BNROwLvZMiKfB4YOCpHjp/V1XAuk6iaGrtMj2X4zqRWYRQHLtHHISNCqGyk+Ax8tHS3WidrL/NZsjW9WL8nwHmQcqH/5ddr3yY3KYi0kCTpv137DC9tE0bXQqHF0A4nLYUvQVarm74gKSTcdelXQh2IJbZH9MQf6N7r7tQLkwa7XOKg+se5P/G8X6rBepaW/Is7QuslpF44C0k6Qwhoj+r+3n38C9RHnLyvcusTcxQF8s4di0zoAj+d3QhIIyxnpv8emwjcUXAspYWKw4HCz0SXaQYx8kqr4=
  - secure: Pwy9s4EfKYRiPqCDZPNJzw10PhPhscdT5QxFwv6amuYv0DewMjLGj+ehx4+jUdWv5D895WvPb0Xpsce+LXqgg+zf+/Kj4LYfk9fNh+tb7ANIArxrq2Vc0CcvXm22CLXKKFB7WG47On0TkjWesRueTGO1VjzY6bXo6/vK0RNYkb00VQyziB3e3I8RhYFaKb6zOSLF40kDXD5OLcy8xzJDfaLmVAKt3gyTOsRKOG0CjDl2n2RbafK4Yjo/9DDaAxc9shHB4nBau7cxw/RS2CQ6IZVbr5H2h2zC9/TnbLi+18vsEUj37Sjg3TaC3UdU5udST3WSLfmcv1F5cLgCU3DIElxWkcFiFLeY5ReaHJO4JKH2wDLTqfLFzG8hhg3YB2Jyc6GnSp4Ny2QkBte2IP2O+5QTe1HZSTL0fpgzSc+MYBBQimG2fkALCm06Iktm6CPRYpNOpB83YfL08dhBEypnFVlantwi/AEl4ixn534YTkqLD+6xkoUlE7w119F8ALUh0TcLm1E+Zt4pqBdesIDcj4834U9SJ5gLF7vPrqL0qvEmKgblwqcrX+n8+htL3BJMCiTzptjskbh8JT6Ud5JW1XmuDc3U4xLj6WLOlSE7nlui9y8LceBrpUTzO3SysU7Wz67izX6yc/aRDUbxeApW/1deDHf/QilCpb5z5IZSauc=
  - secure: aj7avHwzvQ39WHNb0Zqed0kHm3cOCGapPTUpow5OEauMnm5qZIfrofEqqp7lloUZdSTQbvwyIRsxkrDoBYjCEkOiw3u16SQTg02jrQY4qP1GtdI+E+bXPIzuZfGBCnKQhkkEWv77xHhbFeEo8qbV3Rt0qSK3uAA+LD5+6mkkijY8r3/ZZ6rtQzbX/nv8oqvNG9Jh7AtusktfzHdVJMBH0S5FRheTkGTadJHDhuk4WtaAxV3pwnLZ32bCGMbp206Qwbz2+Zcgjlk7OLqMHVr7+jsVnB6x8l3yD6A0EGWhBRkmPSGhB0CnzfvVisW4DT8Ak8c5BOLWFGMS6Qyixrm71BUIcYjmjPRTWc0ZwgD2i7N8YE2otCQ5HTuKS+ss0lZO7e5s4Vv//flQJbSLNx/YtYJT4c3QZWiQUPJrp6OhUKv5GjfQIVxwcexvKGcv3D2/j2zjcL0MrmkjYgQpsH2a4a3E7dhKjEfAdCHMgyJwfgLCAJteAK6lAdjqSxXbawhS1HrqcPe7JdOC9w2cyCmx36vWwdfuKFnOb6fqFFlwYCCZqhBhxvQ3r0N/G4tNZetgkyx8JQuzVSgAwCy7i1WsuVwyNO3FoJrvucbaM2OFa+jwwTh9JRfZk4NS64zv4DMlLAX7zrBU73rqtTSRj5ULf1bdT4HkYDORErXneq8pRDE=
  - secure: rUrUYaifnUjJ+szB9ZZ/v3GM83I8P3L2//3re7JXLIWRoiclihhoMKyzp9gBw5zEghIfbjTMgRL8wdDf5HMUFAWbQ7pj1/zUUBJcMox1gimhlzaBDG6fBfZurz3Nd70YuMShj7NTaJk1MNskYLF4ptOOZXtcaIf+wSftmXQNGtH6sQmKSBoWwK9ir4sGi0y4CZNI4QQZPSWrgKCmHH+wP1wwLyVDdnez7uMWEmAcGxRvCurN5mrdDvjUWWQxR6hBbn0JgGdJaCT7L1yIfYnFZqrnjkc3MuFZG2BWpb000jHk3BdIl9Gd2XvIsc4Z43qx/iDvm2XUo5PAtwMJqndFZsijyGiZMlh0qFGkbL4akuIIyR5HHI9vhz4NqlBeoB+oOZbFYljQWiSy7aQ2q//Z1CfbJGz7PcZTbWOdhFtpzVohVaItaOQgW7VjAdZmJACY9FKQCMt9SfZK2SDZd5L7MSzpd2L6miZCOgYlCunjuQNlKYh96CNZGuR3u7hrdr7eSQRhSgTpuqny5kYDJ1XrVLeOh5c2VIGU+0waaLNeCjnvUFwVG+qERhN6Qd4B+xJnIBcByRqX82gnXyG3s4EaxuC7uycuV+LeQth3banyyOkMhz+wDo0WCJgaqENKRtc+qKdZPz9mBX+QvlVu8zQZ3h2HDsvJqREe0lItB1WMqiY=
  - secure: dG3yqUldWR+NouG4uarOlmZsGwkrtvtAqUfWuJwb2VpGLSD6mJ9nf9dYzqPn3O2tBljsmwV8um0W9sPOgd7RaIIHdXWY+RY0OU3jz2pM4dbRIVsLtHCEfnC/HYdPHAIKV7bU4XnHZnFjQVGxyjnMiHfEqK/OI7SwxpW9m/y0U5nCfBH7hO7gIPgLlvapuLG58vcFGfpSxFOWSux9e97ZByvHO1EFMxJiIjIT602G/G6SiisIJN/JbFra5uO2fQpXKSwoqG5+BNrj4MB5f1QkP7F670tocoXFVVMgGc4/61WR25iT851AuhOpzC0Sr1BMmXfB1P6b6NydN585mhBcbpSeJo9nVuRgaoQxE1nx5J1I5eVDjaNQtXbkAoeYrWdC6dB3zEoCd+2moDjI5v3EcbOZ80gpCS7H19Vpl2JP1cvi011ZPD5lImMoiWgtA+2admawFMRrg5iceKUWMYLQUnqddHCwlQWXGrMkkynrfDLEosuIBMaEzwhrBSE6kyVQkFmGNb8hYFtLihkXBejgsgTpbt400x/Gn3To+tbUTcfzbeS3J5UKiCXoEfxeAo+yKdJ0vCUXcp7i2G5dhFsuZF78ryUN6f5+8u47TiOoPK+/qpNIp70cZfJlB6q1nP/3eClWj0GCAvkx3trt3HoEwiepzMZa5tJx3vPs12Y6gC0=
  - secure: JKkHRgsEHoKNLF5qZSTO8Idu4vfFQIjmZikOUmRM7ZH+gBDiNhIe/kN2Xp2MTTE+gsj1bL4MCWi4+FxAiDpn16Q+K0Jy9GRKXBjKyz7BWyi983wMDF9YAUfH6qjhupa114EJhKPFYC3Cu/I532/x0n2rthPg+AW03b/oXJdUqIGnQmcg9NOoNaXylKx8S7zu91hLyCa3Ymmy5GG0Ef3UKNjpjHRNt92G1J88Ocf7fTyi7m2Sq47pkHIjLO2U8jTz6CJn0UrI9Brcmmi7CGMcn4+jYIMZImW2OvldgO1GLnsNIYxwoSsREAheDgAY7yRfYVi/coxCunpdldwI2fsORfIvOQBOz07C/2jGjofl5AZoNhNrAwAD9inNvuYCqSh2HKCsmiXHeb32VVHZ3neoXX7ZufHIawF+kh1WoGL8p7pxfNTiLyXyYG5qkQJCJ9ZfYAN9sFOpa81d5I9lUwlbUb3O0IgaOt8NQQSdRK4KIMCKrnpAxcDx3SOXJDQSu4oA8/v0zWiWTeBc+UPo4tN/WsHQ/enhAtF4RobmZPKpqb7kkhswPhvC8UQUkGxBr+sDtuCbWly/Z+UuEivGyrEIIMNPsVvBbX3DYZm5JTqW2ReWsM3o/8AQmLWTxUKL4BvetnAfENSr8EinkcpcQUYFDIcdkr+B0kdKOTpPqOBf5Dw=
  - secure: OuY5RaZm3Ikbao2+RPuaVEoabBqXwndSbzlTPdbU5jBHP5/R3vYzPDSfBKS2NeFW8l52JdbtY/dtttXCPdLHT8hq1YvPFr3Rj9RBEzq09g/9Tl5xieMCrpkR8BcHHNEIsl/kZNUJmUVISUxo11ZaLPy0FjI1y2+NDLs6mZpOxdGEFfvLldxpcgOndL+725kIzjBQ2ikx0FKuWEpkRtWisc1T129C5n/flDCn3pnxKaDOje1gNRnAHZHeBErDxRjUAxvJ4fQJfzDxTnB6Di3VqCiHjN8NdolydC7Hvy5HqEA71Ot0maYQeb2wqm0POgAx6NRYQy5HOFOawKdPU2IjBwoCQVGtR5qGcT+Hd23vMiSimxyZaWcKu+ZI+ibQthGM28uDTejkxJDoS5y1GjyDoVSXIUD9J3l43YYTNCP2wALm6X5wCywUfKYuq5qFB5TJp6JEyRrPZm4vMWsEHmOTojGjtUJ2XFQwAo/7Bh88g4Jt8gz7n32vD16o2ysdldiPtoFKAMcSDW4NIYMIVb9jIAKD7nPrGiCf1j3vtxwmVq7LAqLmsb3uv/1vzydkp/yK6bb+xll59yyxFTX0kM0JWpX0bjMv/uUDdZwgWbfSbkU12cCrFg0T4y9E3ePX5kxlHRT0hOiCs4UysPnfWYB8F5IUrwT5AUs93LNq5cUC3Jw=
  - secure: BUf0PpJ2I/760v42llJmeN1cEzpn+mL1DhCK4rNTc/63+h8Q6BP2B1XvTCLNXey4V//h0p/xlsLH0LBJHn/fhZ7Xf2qyBzffHtZuCruLsoFjPfrODmvrBSCxWLqDM6dXxQo45lecIgFqVhEH9Y6Kzd24B2p2wcXn13EY8fuo7N8Nsy8woEabVjY5bbbo7w+Y0qKK7AuNi+i13Jdqdi2hIX0TESC0wQn48rgvo0tJ5zciUQvA+4UVEUky4MJ0E6/YEVbsMXtjBcrABnmVUxpgzSAuhIcuSxioX0xsJEXXDoM4pBPTSVRg8SsIpg8pFztH4UI2BBN4gPopdyNBijC35M+9TXUomt8htWRZRoljJl7BqiFXWHcU1iviPo2//R4BdoF5iBsp7Thi8K/ZuAoIx6flOtIe1kCYV4BEwd3Kz7W7LTtp0b8uzO5hqhrPMPtz/jwYDNJyrU+OD3LLPBOV5UDMfXtSFthMPRUiNlsRo4n4cd1Or8Y3sntuWcKF/pMY+4cz7+sDSab0v+Z2MihZq75f4xh/st9upMcUaPiTKfn/R4IUjKh2cFUoODknHXXcWExezQiDywOgyVYE+QuBx0RS0/YqtlekZHM8/RNGwERgdzhckGOz38Wkd4bMZLw9alW5t1jCH8rA3M92PzKiVulofeAsFObfDilq4ZCPQuc=
jobs:
  include:
  # - stage: Setup and Test application
  #   script: |
  #     bundle exec rake db:create db:schema:load
  #     bundle exec rake test
  # - stage: deploy to staging
  #   script: skip
  #   deploy: heroku
  #     provider: heroku
  #     app: ancient-sea-94054
  #     api_key: $HEROKU_AUTH_TOKEN
  # - stage: Build docker image
  #   script: |
  #     docker login -u "$DOCKER_USER" -p "$DOCKER_PASS"
  #     docker build -t taejunyun/excella-fb:0.1.$TRAVIS_BUILD_NUMBER .
  #     docker push taejunyun/excella-fb:0.1.$TRAVIS_BUILD_NUMBER
  - stage: deploy to ec2
    script: |
      /home/travis/deploy/travis-deploy.sh
